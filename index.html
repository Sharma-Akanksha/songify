<!DOCTYPE html>
<html>
	<head>
		<title>Song App</title>
		<meta charset="UTF-8">
    	<link href="https://use.fontawesome.com/releases/v5.0.8/css/all.css" rel="stylesheet">
    	<link rel="stylesheet" type="text/css" href="style.css">
	</head>
	<body>
		<div class="wrapper">
	        <section class="welcome-screen">
	            <h1> Welcome to Songify </h1>
	            <h3> Enter name to access your account </h3>
	            <div class="input-wrapper">
	                <input type="text" placeholder="Name" id="name-input" value="Akanksha Sharma">
	                <button> Go </button>
	            </div>
	        </section>
	        <div class="main hidden">
	            <!-- main page -->
	            <header>
	                <div class="right floated user-name"> </div>
	            </header>
	            <section class="content">
	                <audio src="song1.mp3"></audio>
	                <div class="song-list">
	                   <div class="list-headers">
	                     <div> Title </div>
	                     <div> Artist </div>
	                     <div> Album </div>
	                     <div> Duration </div>
	                   </div>

	                   <div class="current-song-wrapper">
	                       <img class="current-song-image">
	                       <div>
	                         <p class="current-song-name"></p>
	                         <p class="current-song-album"></p>
	                       </div>
	                     </div>

	                 </div>
	            </section>
	            <footer>
	                <div>
	                    <div class="player-buttons">
	                        <i class="fa fa-play clickable play-icon"></i>
	                    </div>
	                    <div class="progress-wrapper">
	                        <span class="time-elapsed"> </span>
	                        <div class="player-progress">
	                            <div class="progress-filled"> </div>
	                        </div>
	                        <span class="song-duration"></span>
	                    </div>
	                </div>
	            </footer>
	        </div>
    	</div>
    	<script src="jquery-3.3.1.min.js"> </script> 
		<script type="text/javascript">

			$('.welcome-screen button').on('click', function() {
			 	var name = $('#name-input').val();
				//console.log(name);
				if(name.length > 2) {
					$('.welcome-screen').addClass('hidden');
	  				$('.main').removeClass('hidden');

	  				var message = "Welcome " + name;
	    			//console.log(message);

	    			$('.user-name').text(message);
	    			setUpPlaylist() ;
	    		}else {
					$('#name-input').addClass('error');
				}
			});

			$('.play-icon').on('click',function() {
  				var song = document.querySelector('audio');
  				toggleSong();
			});

			$('body').on('keypress',function(event) {
				if (event.keyCode == 32){
			    	var song = document.querySelector('audio');
	  				toggleSong();
				}
			}); 

			function updateCurrentTime() {
  				var song = document.querySelector('audio');

  				var currentTime = Math.floor(song.currentTime);
  				currentTime = fancyTimeFormat(currentTime);

  				var duration = Math.floor(song.duration);
  				duration = fancyTimeFormat(duration);
  				// Get the elements with the class and set the text
  				$('.time-elapsed').text(currentTime);
  				$('.song-duration').text(duration);
			}


			function toggleSong() {
				var song = document.querySelector('audio');

  				if(song.paused == true) {
	    			console.log('Playing');
				    $('.play-icon').removeClass('fa-play').addClass('fa-pause');
				    song.play();
			   	}
   				else {
				    console.log('Pausing');
				    $('.play-icon').removeClass('fa-pause').addClass('fa-play');
				    song.pause();
				}

				updateCurrentTime();
				setInterval(function() {
        			updateCurrentTime();
      			},1000);
			} 

			function fancyTimeFormat(time)
			{   
			    // Hours, minutes and seconds
			    var hrs = ~~(time / 3600);
			    var mins = ~~((time % 3600) / 60);
			    var secs = time % 60;

			    // Output like "1:01" or "4:03:59" or "123:03:59"
			    var ret = "";

			    if (hrs > 0) {
			        ret += "" + hrs + ":" + (mins < 10 ? "0" : "");
			    }

			    ret += "" + mins + ":" + (secs < 10 ? "0" : "");
			    ret += "" + secs;
			    return ret;
			} 

			var songList = ['Badri Ki Dulhania (Title Track)','Humma Song', 'Nashe Si Chadh Gayi', 'The Breakup Song'];
			var fileNames = ['song1.mp3', 'song2.mp3', 'song3.mp3','song4.mp3'];

			function setUpPlaylist() {
		        var songDetailsHTML = '<span class="song-name"> </span><span class="song-artist"> </span> <span class="song-album"> </span><span class="song-length"> </span>' ;

       			for(var i=0; i < songList.length ; i++) {
      				$('.song-list').append('<div id="song' + i + '" class="song">'
                              + songDetailsHTML +'</div>') ;
      				$('#song'+ i +' .song-name').text(songList[i]);

      				$('#song'+ i).attr('data-song-position', i) ;

      				$('#song' + i).click(function() {
            			// Selecting audio element and storing it in a variable
            			var audio = document.querySelector('audio');
            			// Getting the value when clicked
     					var songPosition = $(this).attr('data-song-position');
     					audio.src = fileNames[parseInt(songPosition)] ;
  						toggleSong();
          			});
    			}
		    }
    
		</script>
	</body>	
</html>